---
출처: '[element: Walmart’s Machine Learning Platform](https://medium.com/@bagavath/element-walmarts-machine-learning-platform-b8a1f7870784)'
---

- AI / ML이 소싱부터 배달 사이의 모든 프로세스에서 사용되기 시작함

- 규모에서의 AI, ML의 포텐셜을 알기 위해 모델 트레이닝과 배포를 표준화하는 ML 플랫폼이 필요했다. 

# Vision

- 변혁적인 ML 플랫폼 역량을 개발하여 AI / ML 모델을 대규모 도입을 간소화하여 경쟁 우위를 확보한다.

- element는 이 원칙에 맞추어 프로젝트 플로우 전반에 사용할 수 있도록 구성되었다.

    - Data Ingestion -> Data Prep -> Feature Engineering -> Model Training -> Experimentation -> Model Evaluation -> Model Deployment -> Model Monitoring -> Feedback and Retrain

# Strategy

[image](https://app.capacities.io/d1cf29da-a5be-492d-839a-e228b21e0129/62baa430-4b43-434f-b95c-78c2177f1904)

- 플랫폼은 비전에 맞춘 탑-다운 전략을 사용한다.

    - 비즈니스와 아키텍처 목표는 다음과 같이 주어진다.

        - 속도 & 확장성 : 모델 개발 및 배포를 가속화하고 전사적으로 확장 가능하도록 지원한다.

        - 비용 곡선 완화 : 총 소유 비용을 절감하여 ML의 ROI를 개선한다.

        - 거버넌스 : 책임감 있는 AI 원칙을 통해 신뢰를 구축하고 위험을 완화한다.

        - 미래 대비 : 최신 기술을 활용하여 혁신을 주도한다.

# Execution

## Best-of-Breed

[image](https://app.capacities.io/d1cf29da-a5be-492d-839a-e228b21e0129/9b9018a3-cf29-489c-8e41-18bb75b80217)

- 존재하는 엔터프라이즈 서비스를 재사용하고, 오픈소스를 강화하고, 강한 산업 파트너십을 구축하는 전략

    - 이를 통해 대규모에서 생산성, 속도 혁신을  가능하도록 한다.

- element는 Ground-up으로 여러 레벨의 요구 사항들을 배치하여 설계되었다.

    - 존재하지 않는 솔루션에 대한 기능들은 제작하고, 이미 존재하는 서비스/프레임워크/프로덕트는 그대로 사용했다.

        - 이를 통해 팀이 핵심 역량에 집중하고, 전체 소유 비용을 절감하며, 시장 출시 속도를 높일 수 있었다.

- 아키텍처의 주요 컴포넌트는 환경에 맞추어 커스텀되었고, 다음과 같은 유즈케이스가 있다.

    - 자원 관리 : 플랫폼이 자원 프로비저닝과 최적화를 멀티클라우드 상에서 관리하고, 클라우드 복잡성을 추상화하여 DS에게 제공한다.

    - 비용 귀속 : 워크로드가 사용량 최적화를 위해 공유 멀티 테넌트 클러스터에서 실행되므로, 커스텀 비용 귀속 프레임워크를 개발했다.

    - 유저 관리 및 협업 : AD로 컨트롤하여 모델 개발과 ML 아티펙트를 공유하는 공유 워크스페이스를 팀 단위로 제공한다.

    - 노트북 : 오픈소스 노트북을 커스텀해 보안과 개발자 생산성을 향상시켰다.

    - 실시간 배포 : 월마트의 표준 CI/CD툴에 기반한 커스텀 MLOps 프레임워크로 유저가 멀티 클라우드 / 리전에 모델을 배포하고 모니터링 할 수 있도록 제공

[image](https://app.capacities.io/d1cf29da-a5be-492d-839a-e228b21e0129/0d9448d6-133c-4d40-bf70-5eeee22f4860)

- 많은 오픈소스 툴과 프레임워크를 기반으로 개발되었다.

    - 유즈케이스에 맞춰 오픈 소스 프레임워크를 커스텀하여 사용했다.

        - 주피터에 인증 레벨 추가, MLFlow에 멀티 테넌시 지원 추가, 런타임 자원 사용량 추적과 definition 파일을 통한 자동 환경 설정을 위한 주피터/Theia 플러그인, 노트북 배치 실행을 위한 커스텀 에어플로우 배치 등

    - 플랫폼은 다른 팀의 기여를 받아 능력을 강화할 수 있도록 했다.

- 클라우드 기술을 활용하고 멀티 클라우드에서 테스트해서 플랫폼이 빠르게 발전할 수 있었다.

    - 멀티클라우드 전략을 도입하여 element는 플랫폼이 여러 ML 워크로드를 여러 클라우드/리전에서 심리스하게 통합되고 작동하도록 구성하는데 집중하였다.

- AI/ML은 엄청난 혁신이 자주 일어난다.

    - 이러한 속도를 따라기 위해 구글, 엔비디아, MS 등의 산업 리더들과 파트너를 맺었다.

    - 클라우드 네이티브 솔루션, 라이브러리, 하드웨어들을 채용해다.

- 현재도 진행중인 변화고 클라우드 플랫폼, 오픈소스, 서드파티 사이에서 계속 움직일거다.

# Speed and Scale

- 플랫폼의 타겟 페르소나는 데이터 엔지니어링, ML과 데브옵스 스킬을 갖춘 DE와 DS, MLE이다.

    - element는 DE와 DS에게 쉽고 협업 가능한 개발 환경, MLE에게 심리스 배포 프레임워크를 제공한다.

- 생태계 내부의 공유 서비스들과 잘 통합되도록 구성했다.

- 플랫폼은 20개 이상의 데이터 커넥터를 제공하여 분리된 시스템에서 데이터를 가져올 수 있다.

    - 데이터를 가져와 팀의 협업 워크스테이션의 협업 IDE으로 가져와 사용할 수 있다.

- 플랫폼은 패키징된 라이브러리와 커스텀을 위한 의존성도 제공하여 바로 사용할 수 있는 DS 환경을 제공한다.

- 빌드된 노코드 AI서비스를 제공하여 DE, SWE, DS가 DS 스킬 없이 AI/ML을 사용할 수 있도록 한다.

- 개발자의 생산성 향상에 집중하여, element는 모델 트레이닝과 모델 배포의 다른 스텝을 자동화한다.

    - DS가 ML을 채용하는 것을 빠르게 한다.

- 프로덕션 배포에 걸리는 시간을 2주에서 몇시간으로 줄였고, 다음과 같은 이점을 얻었다..

    - 엔터프라이즈 표준 CI/CD 툴을 통한 완전 자동화 모델 배포

    - 멀티클라우드 / 멀티리전 배포

    - 여러 개의 환경 구성에 대한 자동 프로모션

    - 연산 오토스케일링을 통한 최적화된 비용

    - 배포 리스크를 줄이기 위한 여러 배포 전략 사용

    - 중앙화된 로깅과 모니터링 서비스를 통한 관측 가능성

    - 배포 환경에서의 재해 복구

# Bend-the-Cost-Curve

- 플랫폼에 유즈케이스가 늘어날수록, 클라우드 비용이 늘어났다.

- Every Day Low Cost가 운영 원칙의 핵심이고 따라서 플랫폼은 워크로드에서 유저를 방해하지 않는 비용 최적화 전략을 도입했다.

- 다음과 같은 전략을 사용했다.

    - 멀티 테넌트 워크로드에 대해 공유 인프라를 사용하여 플랫폼의 리소스 사용률을 높임

    - 클라우드 온디맨드 리소스 프로비저닝

    - 모든 워크로드에 대한 클라우드 오토스케일링 (스케일업/다운 모두) 설정

    - 유저 워크로드 요청에 따른 VM 모델 선택

    - 아이들 상태 리소스에 대한 자동 클린업

    - 유저 액션에 대한 인사이트로 자원 추천 및 사용률 향상

    - 가능한 경우 저비용 / 선점 가능 자원을 사용하여 운영 비용 감축

    - 다른 엔터프라이즈 서비스 사용을 강화하여 운영 비용 감축

# Governance

- AI와 ML 사용에 대한 스케일이 커지고 혁신이 이어지면서, 모든 프레임워크가 기술적인 요구사항, 법적 문제, 도덕적 문제를 위반하지 않는지 보장하는 거버넌스 프레임워크가 필요해졌다.

- 거버넌스 프레임워크는 2개의 키 엘리먼트로 구성된다.

    1. 정책과 프로세스 정의 

        - 도덕과 기술의 책임감 있는 사용, 데이터가 Data Science Governance Council에서 정의된대로 사용되는지 여부에 대한 원칙

    2. 기술적인 enabler

        - 거버넌스 정책을 보장하고 쉽게 적용할 수 있도록 하는 툴과 자동화 프레임워크

-  거버넌스 역량 중 일부를 다음과 같이 프로세스 내부에 구축했으며, 추가로 만들고 있다.

    - 접근 제어 : 아티펙트(데이터셋, 모델, 노트북)에 접근하기 위한 인증 절차

    - 데이터 보안 : 저장 상태와 움직이고 있을 때의 데이터 암호화

    - 회계 가능성 : 아티팩트의 소유권 기록

    - 상태 모니터링 : 모델의 퍼포먼스와 health를 모니터링하는 대시보드

    - 지속적 개선 : 모델의 재훈련 필요를 인지하기 위한 데이터 드리프트나 데이터 불균형을 모니터링

    - 공정성 평가 : 예민한 모델에 대한 공정성과 편향 모니터링

    - 투명성 : 지분 보유자들의 신뢰를 개선하기 위한 설명 가능한 출력 제공

# Conclusion

- element 플랫폼은 비즈니스와 아키텍처와 부합하는 다양한 기능을 가진 플랫폼으로 발전했다.

- 온프레미스 클라우드 환경의 하나의 쿠버네티스 클러스터로 시작해서 멀티클라우드의 20개 이상의 서비스, 1000개의 CPU와 100개 이상의 GPU를 사용하는 서비스로 발전했다.

    - 현재 수백 명의 사용자가 플랫폼을 통해 수천 개의 모델을 관리하고 있다.

